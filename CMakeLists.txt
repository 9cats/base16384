cmake_minimum_required(VERSION 3.0.0)
project(base16384 VERSION 2.0)
SET(CMAKE_BUILD_TYPE "Release")
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -march=native")

add_executable(base16384 base16384.c)

include(TestBigEndian)
test_big_endian(isBigEndian)
if (${isBigEndian})
    add_definitions(-DWORDS_BIGENDIAN)
endif()

IF(CMAKE_SIZEOF_VOID_P EQUAL 8)
    add_library(b1464 STATIC base1464.c)
    add_library(b14 SHARED base1464.c)
    target_link_libraries(base16384 b1464)
ELSE()
    add_library(b1432 STATIC base1432.c)
    add_library(b14 SHARED base1432.c)
    target_link_libraries(base16384 b1432)
ENDIF()

INSTALL(TARGETS base16384 RUNTIME DESTINATION bin)
INSTALL(TARGETS b14 LIBRARY DESTINATION lib)
INSTALL(FILES base14.h DESTINATION include)